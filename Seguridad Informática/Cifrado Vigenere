# CIFRADO VIGENÈRE
def generar_clave(texto, clave):
    """
    Ajusta la clave al tamaño del texto
    ignorando caracteres no alfabéticos
    """
    clave = clave.lower()
    clave_generada = ""
    indice_clave = 0

    for caracter in texto:
        if caracter.isalpha():
            clave_generada += clave[indice_clave % len(clave)]
            indice_clave += 1
        else:
            clave_generada += caracter

    return clave_generada


def cifrar_vigenere(texto, clave):
    """
    Cifra un texto usando el cifrado Vigenère
    """
    texto_cifrado = ""
    clave_generada = generar_clave(texto, clave)

    for t, k in zip(texto, clave_generada):
        if t.isalpha():
            base = ord('A') if t.isupper() else ord('a')
            desplazamiento = ord(k.lower()) - ord('a')
            nuevo_caracter = chr((ord(t) - base + desplazamiento) % 26 + base)
            texto_cifrado += nuevo_caracter
        else:
            texto_cifrado += t

    return texto_cifrado


def descifrar_vigenere(texto_cifrado, clave):
    """
    Descifra un texto usando el cifrado Vigenère
    """
    texto_descifrado = ""
    clave_generada = generar_clave(texto_cifrado, clave)

    for t, k in zip(texto_cifrado, clave_generada):
        if t.isalpha():
            base = ord('A') if t.isupper() else ord('a')
            desplazamiento = ord(k.lower()) - ord('a')
            nuevo_caracter = chr((ord(t) - base - desplazamiento) % 26 + base)
            texto_descifrado += nuevo_caracter
        else:
            texto_descifrado += t

    return texto_descifrado

# PRUEBA 
mensaje = "El método de cifrado polialfabético basado en sustituciones César múltiples"
clave = "Giovan Battista Bellaso"

print("CIFRADO VIGENÈRE\n")

print("Mensaje original:")
print(mensaje)

mensaje_cifrado = cifrar_vigenere(mensaje, clave)
print("\nMensaje cifrado:")
print(mensaje_cifrado)

mensaje_descifrado = descifrar_vigenere(mensaje_cifrado, clave)
print("\nMensaje descifrado:")
print(mensaje_descifrado)